(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?b(exports,require('react'),require('react-dom')):'function'==typeof define&&define.amd?define(['exports','react','react-dom'],b):b(a.Remount={},a.React,a.ReactDOM)})(this,function(a,b,c){'use strict';function d(){return window.customElements&&window.customElements.define}function e(a,{shadow:b}){if(b){const b=document.createElement('span');return a.attachShadow({mode:'open'}).appendChild(b),b}return a}function f(){return!!window.MutationObserver}function g({component:a,attributes:d},e,f){const g=b.createElement(a,f);c.render(g,e)}function h(a,b){c.unmountComponentAtNode(b)}function i(a){return'object'==typeof a&&a.component?a:{component:a}}function j(a,b){const c=a.getAttribute('props-json');if(c)return JSON.parse(c);return(b||[]).reduce((b,c)=>(b[c]=a.getAttribute(c),b),{})}c=c&&c.hasOwnProperty('default')?c['default']:c;var k=Object.freeze({defineElement:function(a,b,{onUpdate:c,onUnmount:d}){const f=a.attributes||[];class g extends window.HTMLElement{static get observedAttributes(){return['props-json',...f]}connectedCallback(){this._mountPoint=e(this,a),c(this,this._mountPoint)}disconnectedCallback(){this._mountPoint&&d(this,this._mountPoint)}attributeChangedCallback(){this._mountPoint&&c(this,this._mountPoint)}}a.quiet&&window.customElements.get(b)||window.customElements.define(b,g)},isSupported:d,name:'CustomElements'});var l=Object.freeze({isSupported:f,defineElement:function(a,b,{onUpdate:c,onUnmount:d}){b=b.toLowerCase();const e=new window.MutationObserver(a=>{a.forEach(a=>{console.log('mutationobserver: mutation',a),a.addedNodes.forEach(a=>{a.nodeName.toLowerCase()!==b||c(a,a)}),a.removedNodes.forEach(a=>{a.nodeName.toLowerCase()!==b||d(a,a)})})});e.observe(document.body,{attributes:!0,childList:!0,subtree:!0})},name:'MutationObserver'});const m=d()?k:f()?l:null;if(!m)throw new Error('Unsupported platform');else console.log('Remount: using adapter',m.name);const n=m.name;a.adapterName=n,a.define=function(a,b){Object.keys(a).forEach((c)=>{const d=Object.assign({},b,i(a[c]));m.defineElement(d,c,{onUpdate(a,b){const c=j(a,d.attributes);g(d,b,c)},onUnmount(a,b){h(d,b)}})})},Object.defineProperty(a,'__esModule',{value:!0})});
